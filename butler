(
 ((or ((glob "_build")
       (glob "*#")
       (glob "*.swp")
       (glob "*~")))
  ignore)

 ((or ((glob "lib/*.ml{,i}")
       (glob "bin/*.ml{,i}")))
  (run ("jbuilder" "build" "--debug-backtraces" "bin/main.bc")))

 ((or ((glob "lib/*.ml{,i}")
       (glob "bin/*.ml{,i}")
       (glob "test/*.ml{,i}")))
  (seq
   ((run ("jbuilder" "build" "--debug-backtraces" "test/tests.bc"))
    (timeout (5 ("./_build/default/test/tests.bc"))))))
 )
